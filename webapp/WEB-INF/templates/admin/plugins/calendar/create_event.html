<#include "/admin/plugins/calendar/util/calendar.html" />
<#include "/admin/util/editor/editor.html" />
<#escape x as x?html>
<div class="row-fluid" >
	<div class="span12">
		<form class="form-horizontal" method="post" name="create_event" action="jsp/admin/plugins/calendar/DoCreateEvent.jsp" enctype="multipart/form-data">
			<input type="hidden" name="calendar_id" value="${calendar_id}">
			<ul class="nav nav-tabs">
				<li class="active">
					<a href="#panel1"  data-toggle="tab">
						#i18n{calendar.create_event.pageTitle}
					</a>
				</li>
				<li>
					<a href="#panel2"  data-toggle="tab">
						#i18n{calendar.create_event.advanced_parameters}
					</a>
				</li>
			</ul>		
			<div class="tab-content">
				<div class="tab-pane active" id="panel1">
					<div class="control-group">
						<label class="control-label" for="event_title">#i18n{calendar.create_event.title} *</label>
						<div class="controls form-inline">
							<input type="text" id="event_title" name="event_title" tabindex="1" class="input-xxlarge" maxlength="60" >
							<label for="event_top_event">#i18n{calendar.create_event.topevent} *</label>
							<@comboWithParams name="event_top" default_value="${top_event_default}" items=top_event_list additionalParameters="class=\"input-small\"" />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_description">#i18n{calendar.modify_event.description} *</label>
						<div class="controls">
							<textarea id="event_description" class="richtext" tabindex="3" name="event_description" rows="4" ></textarea>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_description">#i18n{calendar.create_event.event_hour_and_time}</label>
						<div class="controls form-inline">
							<label  for="event_date">#i18n{calendar.create_event.date} *</label>
							<div class="input-prepend">
								<span class="add-on">
									<i class="icon-calendar"></i>
								</span>	
								<input type="text" title="(dd/MM/yyyy)" name="event_date" id="event_date" tabindex="4" class="input-small" value="">
							</div>	
							<label for="event_time_start">#i18n{calendar.create_event.time_start}</label>
							<div class="input-prepend">
								<span class="add-on">
									<i class="icon-time"></i>
								</span>	
								<input type="text" title="(hh:mm)" id="event_time_start" name="event_time_start" tabindex="2" class="input-mini timepicker-default" maxlength="5" >
							</div>	
							<label  for="event_time_end">#i18n{calendar.create_event.time_end}</label>
							<div class="input-prepend">
								<span class="add-on">
									<i class="icon-time"></i>
								</span>	
								<input type="text" title="(hh:mm)" id="event_time_end" name="event_time_end" tabindex="3" class="input-mini timepicker-default" maxlength="5" >
							</div>	
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">#i18n{calendar.create_event.periodicity_choice}</label>
						<div class="controls form-inline">
							<label class="radio">#i18n{calendar.create_event.date_end}
								<input type="radio" class="radio" name="radioPeriodicity" value="1"  id="radio_1"<#if time_span="FALSE">checked="checked"</#if>>
							</label>
							<div class="input-prepend">
								<span class="add-on">
									<i class="icon-calendar"></i>
								</span>	
								<input type="text" name="event_date_end" id="event_date_end" class="input-small" value="">
							</div>	
							<label class="radio">#i18n{calendar.create_event.labelor} #i18n{calendar.create_event.periodicity}
								<input class="radio" name="radioPeriodicity" value="0" id="radio_2"<#if time_span="TRUE">checked="checked"</#if> type="radio" />
							</label>
							<@comboWithParams name="periodicity" default_value="${number_days}" additionalParameters=" class=\"input-medium\"" items=interval_list />
							<label>#i18n{calendar.create_event.occurrence}</label>
							<input type="number" value="0" id="occurrence" name="occurrence" tabindex="3" class="input-mini" maxlength="3">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="excluded_days">#i18n{calendar.create_event.excluded_days}</label>
						<div class="controls form-inline">
							<label class="checkbox inline">
								<input type="checkbox" value="2" name="excluded_days" >#i18n{calendar.label.monday}
							</label>
							<label class="checkbox inline">
								<input type="checkbox" class="checkbox" value="3" name="excluded_days"> #i18n{calendar.label.tuesday}
							</label>
							<label class="checkbox inline">
								<input type="checkbox" class="checkbox" value="4" name="excluded_days"> #i18n{calendar.label.wednesday}
							</label>
							<label class="checkbox inline">
								<input type="checkbox" class="checkbox" value="5" name="excluded_days"> #i18n{calendar.label.thursday}
							</label>
							<label class="checkbox inline">
								<input type="checkbox" class="checkbox" value="6" name="excluded_days"> #i18n{calendar.label.friday}
							</label>
							<label class="checkbox inline">
								<input type="checkbox" class="checkbox" value="7" name="excluded_days"> #i18n{calendar.label.saturday}
							</label>    
							<label class="checkbox inline">
								<input type="checkbox" class="checkbox" value="1" name="excluded_days"> #i18n{calendar.label.sunday}
							</label>
						</div>
					</div>
					
				</div>
				<div class="tab-pane" id="panel2">
					<div class="control-group">
						<label class="control-label" for=""></label>
						<div class="controls">
							<label class="checkbox">
								<input type="checkbox" name="notify" class="checkbox" value="${notify}" checked="${notify}">#i18n{calendar.create_event.notify}
							</label>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_category">#i18n{calendar.create_event.category}</label>
						<div class="controls">
							<@multiCombo name="category" list_default_values=category_default_list items=category_list />
							<p class="help-block">#i18n{calendar.modify_event.labelMultiCategorySelection}</p>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_image">#i18n{calendar.create_event.imagelink}</label>
						<div class="controls">
							<input type="file" id="event_image" name="event_image" class="input-normal" >
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_location">#i18n{calendar.create_event.location}</label>
						<div class="controls">
							<input type="text" id="event_location" name="event_location" class="input-normal" maxlength="60" />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_location_address">#i18n{calendar.create_event.location.address}</label>
						<div class="controls">
							<input type="text" id="event_location_address" name="event_location_address" class="input-normal" maxlength="130" />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_location_town">#i18n{calendar.create_event.location.town}</label>
						<div class="controls">
							<input type="text" id="event_location_town" name="event_location_town" class="input-normal" maxlength="130" />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_location_zip">#i18n{calendar.create_event.location.zip}</label>
						<div class="controls">
							<input type="text" id="event_location_zip" name="event_location_zip" class="input-small" maxlength="20" />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_tags">#i18n{calendar.create_event.tags} </label>
						<div class="controls">
							<input type="text" id="event_tags" name="event_tags" class="input-normal" maxlength="130">
							<span class="help-block"> #i18n{calendar.create_event.separator}</span>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_map">#i18n{calendar.create_event.map}</label>
						<div class="controls">
							<input type="text" id="event_map_url" name="event_map_url" class="input-normal" maxlength="130" />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_linkurl">#i18n{calendar.create_event.linkurl}</label>
						<div class="controls">
							<input type="text" id="event_link_url" name="event_link_url" class="input-normal" maxlength="130" />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_document_id">#i18n{calendar.create_event.documentid}</label>
						<div class="controls">
							<div class="input-append">
								<input type="text" id="event_document_id" name="event_document_id" class="input-mini" maxlength="130" value="">
								<button type="button" class="btn insert-service" data-url="${insert_service_page}">
									<img src="images/admin/skin/plugins/calendar/ed_linkservice2.png">
								</button> 
							</div>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="event_page_url">#i18n{calendar.create_event.pageurl}</label>
						<div class="controls">
							<div class="input-append">
							<input type="text" id="event_page_url" name="event_page_url" class="input-normal" maxlength="130" value="">
								<button type="button" class="btn insert-service" data-url="${insert_service_link_page}">
									<img src="images/admin/skin/plugins/calendar/ed_linkservice2.png">
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="form-actions">
						<button class="btn btn-primary btn-small" type="submit" >
							<i class="icon-ok icon-white"></i>&nbsp;#i18n{calendar.create_event.buttonLabelCreate}
						</button>
						<a class="btn btn-small" href="jsp/admin/plugins/calendar/EventList.jsp?plugin_name=calendar&calendar_id=${calendar_id}" >
							<i class="icon-remove-circle"></i>&nbsp;#i18n{calendar.modify_event.backToEventList}
						</a>
			</div>
		</form>
	</div>
</div>
</#escape>
<script>
$(document).ready( function(){
	$(".insert-service").click( function(){
		var page=$(this).attr("data-url");
		window.open(page,"","toolbar=no, scrollbars=yes, status=yes, location=no, directories=no, menubar=no, width=550, height=450");
	});
	
	$("#event_date_end").focus(function(){
		$("#radio_1").attr('checked','checked')
	});
	
	$("#periodicity").change( function(){
		$("#radio_2").attr('checked','checked')
	});
	
    // Function to activate the tab
    function activateTab() {
        var activeTab = $('[href=' + window.location.hash.replace('/', '') + ']');
        activeTab && activeTab.tab('show');
    }

    // Trigger when the page loads
    activateTab();

});
</script>

<@initEditor />

<script src="js/jquery/plugins/ui/jquery-ui-1.8.16.custom.min.js"></script>
<script src="js/jquery/plugins/ui/ui.datepicker-fr.js"></script>
<script src="js/jquery/plugins/ui/timepicker/jquery-ui-timepicker-addon.js"></script>
<script src="js/jquery/plugins/ui/timepicker/jquery-ui-sliderAccess.js"></script>
<script src="js/jquery/plugins/ui/timepicker/localization/jquery-ui-timepicker-${locale}.js"></script>
<script>$('.timepicker-default').timepicker();</script>

<@getDatePickerRange idFieldFrom="event_date" idFieldTo="event_date_end" language=locale />